<div class="flex items-start space-x-4 px-6">
  <div class="flex-shrink-0">
    <div class="h-10 w-10 bg-gray-200 rounded-full flex items-center justify-center">
      <span class="text-lg font-medium text-gray-600">
        <%= message.user.username.first.upcase %>
      </span>
    </div>
  </div>
  <div class="flex-1 min-w-0">
    <div class="flex items-baseline space-x-2 mb-1">
      <span class="font-semibold text-gray-900"><%= message.user.username %></span>
      <span class="text-xs text-gray-500" title="<%= message.created_at.strftime('%B %d, %Y at %I:%M %p') %>">
        <%= message.created_at.strftime('%I:%M %p') %>
      </span>
    </div>
    <div class="message-body text-gray-800 leading-relaxed"><%= render_message_body(message.content).html_safe %></div>
    <%= render_link_previews(message) %>
    <% if message.files.attached? %>
      <div class="mt-2 space-y-2">
        <% message.files.each do |file| %>
          <% if file.image? %>
            <%= image_tag file, class: "max-h-56 rounded-lg border border-gray-200 cursor-zoom-in", data: { controller: 'lightbox', action: 'click->lightbox#open' } %>
          <% else %>
            <%= link_to file.filename, url_for(file), class: "text-sm text-blue-600 hover:text-blue-700 underline" %>
          <% end %>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
